// After datatype + constraint validation success

const dummyId = cds.utils.uuid();

await tx.run(
  INSERT.into("COM_SCB_FILEUPLOAD_MASTER_DUMMY").entries({
    ID: dummyId,
    JSON_DATA: JSON.stringify(jsonData)
  })
);

// Call procedure normally
const procResult = await tx.run(
  `CALL "GENERIC_DATA_VALIDATOR"(?, ?, ?, ?)`,
  [
    dummyId,
    MODULE_NAME,
    SUB_MODULE_NAME,
    LOAD_TEMPLATE
  ]
);

console.log("Duplicate validator RESULT:", procResult);

const status = procResult[0].O_STATUS;
const message = procResult[0].O_MESSAGE;

if (status === 'E') {

  await tx.run(
    DELETE.from("COM_SCB_FILEUPLOAD_MASTER_DUMMY").where({ ID: dummyId })
  );

  return {
    flag: false,
    message: message
  };
}

return {
  flag: true,
  message: "Proceed"
};
